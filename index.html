<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Fahrschüler – Beobachtung & Dokumentation</title>
<meta name="theme-color" content="#0f172a" />
<style>
:root{--pri:#28a745;--bg:#0f172a;--card:#1e293b;--txt:#f8fafc;--mut:#94a3b8;--bd:#475569}
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;background:var(--bg);color:var(--txt);font-family:system-ui,Segoe UI,Roboto,sans-serif;padding:12px}
h1,h2,h3,h4{margin:.4rem 0}
small{color:var(--mut)}
.card{background:var(--card);border-radius:12px;box-shadow:0 2px 10px rgba(0,0,0,.45);padding:12px;margin-top:12px}
input,select,textarea,button{width:100%;padding:.6rem;border-radius:10px;border:1px solid var(--bd);background:#0b1220;color:var(--txt)}
textarea{resize:vertical}
button{cursor:pointer}
button.primary{background:var(--pri);border:0;color:#fff}
button.ghost{background:#1e293b;border:1px solid var(--bd);color:var(--txt)}
.row{display:flex;gap:10px;flex-wrap:wrap}
.row>*{flex:1}
.grid{display:grid;gap:10px;grid-template-columns:repeat(auto-fit,minmax(220px,1fr))}
.tabs{display:flex;gap:6px;margin:10px 0;flex-wrap:wrap}
.tabs button{flex:1;background:#334155;border:1px solid var(--bd);color:#fff}
.tabs button.active{background:var(--pri);border-color:var(--pri)}
.hidden{display:none}
table{width:100%;border-collapse:collapse;margin:.5rem 0}
th,td{border:1px solid var(--bd);padding:.35rem;text-align:center}
th.sticky{position:sticky;top:0;background:#223047}
.label{font-weight:600;margin-top:.35rem;display:block}
.hr{height:1px;background:var(--bd);opacity:.5;margin:.8rem 0}
.badge{display:inline-block;padding:.2rem .5rem;border-radius:.6rem;border:1px solid var(--bd);color:var(--mut);font-size:.8rem}
pre{white-space:pre-wrap;word-break:break-word}
</style>
</head>
<body>

<h1>Fahrschüler – Beobachtung & Dokumentation</h1>

<!-- SCHÜLER-VERWALTUNG -->
<div class="card">
  <h2>Fahrschüler</h2>
  <label class="label">Auswählen</label>
  <select id="studentSelect" onchange="onSelectStudent()">
    <option value="">-- Bitte wählen --</option>
  </select>

  <div class="hr"></div>

  <div class="row">
    <div>
      <label class="label">Neuer Schüler</label>
      <input id="newStudentName" placeholder="z. B. Max Mustermann" />
    </div>
    <div>
      <label class="label">Führerscheinklasse(n)</label>
      <select id="klasseSelect" multiple size="6">
        <option>AM</option><option>A1</option><option>A2</option><option>A</option>
        <option>B</option><option>BE</option><option>B97</option><option>B197</option><option>C1</option><option>C1E</option><option>C</option>
        <option>CE</option><option>D1</option><option>D1E</option><option>D</option><option>L</option><option>T</option>
      </select>
    </div>
  </div>
  <div class="row">
    <button class="primary" onclick="addStudent()">Schüler hinzufügen</button>
    <button class="ghost" onclick="deleteStudent()">Schüler löschen</button>
  </div>
  <small>Speicherung lokal auf diesem Gerät. Offline nutzbar.</small>
</div>

<!-- TABS -->
<div class="tabs">
  <button id="tab-beratung"  onclick="switchTab('beratung')">Beratung</button>
  <button id="tab-theorie"   onclick="switchTab('theorie')">Theorie</button>
  <button id="tab-praxis"    onclick="switchTab('praxis')">Praxis</button>
  <button id="tab-uebersicht"onclick="switchTab('uebersicht')">Übersicht</button>
</div>

<!-- BERATUNG – PDF 03 1:1 -->
<div id="beratung" class="card">
  <h3>Beobachtungshilfe – Beratungsgespräch</h3>

  <div class="grid">
    <div><label class="label">Datum</label><input type="date" id="b_datum"></div>
    <div><label class="label">Dauer (Min)</label><input type="number" id="b_dauer"></div>
    <div><label class="label">Gesprächspartner</label><input id="b_partner" placeholder="Fahrschüler, Elternteil, …"></div>
    <div><label class="label">Fahrerlaubnisklasse</label><input id="b_klasse" placeholder="B, BE, A …"></div>
  </div>

  <div class="hr"></div>

  <div class="grid">
    <label><input type="checkbox" id="b_inhalte"> Inhalte/Ausbildung erklärt</label>
    <label><input type="checkbox" id="b_aengste"> Ängste/Erwartungen erfragt</label>
    <label><input type="checkbox" id="b_fragen"> Rückfragen geklärt</label>
  </div>

  <label class="label">Bemerkung</label>
  <textarea id="b_bem" rows="3"></textarea>

  <label class="label">Fehlende Informationen</label>
  <textarea id="b_fehl" rows="2"></textarea>

  <div class="grid">
    <div>
      <label class="label">Kosten / Unterlagen</label>
      <textarea id="b_kosten" rows="2"></textarea>
    </div>
    <div>
      <label class="label">Gesamteindruck</label>
      <textarea id="b_eindruck" rows="2"></textarea>
    </div>
  </div>

  <div class="row">
    <button class="primary" onclick="saveBeratung()">Beratung speichern</button>
  </div>
</div>

<!-- THEORIE – PDF 05 1:1 (mit °) -->
<div id="theorie" class="card hidden">
  <h3>Beobachtungshilfe – Theorieunterricht</h3>

  <div class="grid">
    <div><label class="label">Datum</label><input type="date" id="t_datum"></div>
    <div><label class="label">Uhrzeit</label><input type="time" id="t_time"></div>
    <div><label class="label">Anzahl FS*</label><input type="number" id="t_anz"></div>
    <div><label class="label">Lektion / Thema</label><input id="t_thema"></div>
  </div>

  <div class="grid">
    <label><input type="checkbox" id="t_grund"> Grundstoff</label>
    <label><input type="checkbox" id="t_zusatz"> Zusatzstoff</label>
  </div>

  <h4>Fahrlehrerverhalten</h4>
  <table>
    <thead>
      <tr>
        <th class="sticky">Aspekt</th>
        <th>++</th><th>+</th><th>°</th><th>–</th><th>––</th>
        <th>Bemerkung</th>
      </tr>
    </thead>
    <tbody>
      <!-- Pro Zeile eine Radio-Gruppe (nur eine Auswahl erlaubt) -->
      <tr>
        <td>Umgangston</td>
        <td><input type="radio" name="t_ton" value="++"></td>
        <td><input type="radio" name="t_ton" value="+"></td>
        <td><input type="radio" name="t_ton" value="°"></td>
        <td><input type="radio" name="t_ton" value="-"></td>
        <td><input type="radio" name="t_ton" value="--"></td>
        <td><input id="t_ton_bem"></td>
      </tr>
      <tr>
        <td>Variantenreiche Lautstärke</td>
        <td><input type="radio" name="t_laut" value="++"></td>
        <td><input type="radio" name="t_laut" value="+"></td>
        <td><input type="radio" name="t_laut" value="°"></td>
        <td><input type="radio" name="t_laut" value="-"></td>
        <td><input type="radio" name="t_laut" value="--"></td>
        <td><input id="t_laut_bem"></td>
      </tr>
      <tr>
        <td>Arbeit mit der Stimme (Betonung)</td>
        <td><input type="radio" name="t_stimme" value="++"></td>
        <td><input type="radio" name="t_stimme" value="+"></td>
        <td><input type="radio" name="t_stimme" value="°"></td>
        <td><input type="radio" name="t_stimme" value="-"></td>
        <td><input type="radio" name="t_stimme" value="--"></td>
        <td><input id="t_stimme_bem"></td>
      </tr>
      <tr>
        <td>Sprechtempo</td>
        <td><input type="radio" name="t_tempo" value="++"></td>
        <td><input type="radio" name="t_tempo" value="+"></td>
        <td><input type="radio" name="t_tempo" value="°"></td>
        <td><input type="radio" name="t_tempo" value="-"></td>
        <td><input type="radio" name="t_tempo" value="--"></td>
        <td><input id="t_tempo_bem"></td>
      </tr>
      <tr>
        <td>Fachbegriffe/Alltagssprache</td>
        <td><input type="radio" name="t_begr" value="++"></td>
        <td><input type="radio" name="t_begr" value="+"></td>
        <td><input type="radio" name="t_begr" value="°"></td>
        <td><input type="radio" name="t_begr" value="-"></td>
        <td><input type="radio" name="t_begr" value="--"></td>
        <td><input id="t_begr_bem"></td>
      </tr>
      <tr>
        <td>Gestik/Bewegung</td>
        <td><input type="radio" name="t_gestik" value="++"></td>
        <td><input type="radio" name="t_gestik" value="+"></td>
        <td><input type="radio" name="t_gestik" value="°"></td>
        <td><input type="radio" name="t_gestik" value="-"></td>
        <td><input type="radio" name="t_gestik" value="--"></td>
        <td><input id="t_gestik_bem"></td>
      </tr>
      <tr>
        <td>Blickkontakt</td>
        <td><input type="radio" name="t_blick" value="++"></td>
        <td><input type="radio" name="t_blick" value="+"></td>
        <td><input type="radio" name="t_blick" value="°"></td>
        <td><input type="radio" name="t_blick" value="-"></td>
        <td><input type="radio" name="t_blick" value="--"></td>
        <td><input id="t_blick_bem"></td>
      </tr>
      <tr>
        <td>Mimik</td>
        <td><input type="radio" name="t_mimik" value="++"></td>
        <td><input type="radio" name="t_mimik" value="+"></td>
        <td><input type="radio" name="t_mimik" value="°"></td>
        <td><input type="radio" name="t_mimik" value="-"></td>
        <td><input type="radio" name="t_mimik" value="--"></td>
        <td><input id="t_mimik_bem"></td>
      </tr>
      <tr>
        <td>Lehrer–Schüler–Verhältnis</td>
        <td><input type="radio" name="t_ls" value="++"></td>
        <td><input type="radio" name="t_ls" value="+"></td>
        <td><input type="radio" name="t_ls" value="°"></td>
        <td><input type="radio" name="t_ls" value="-"></td>
        <td><input type="radio" name="t_ls" value="--"></td>
        <td><input id="t_ls_bem"></td>
      </tr>
    </tbody>
  </table>

  <div class="row">
    <div>
      <h4>Methoden</h4>
      <label><input type="checkbox" id="t_m_frontal"> Frontalunterricht</label>
      <label><input type="checkbox" id="t_m_lehr"> Lehrgespräch</label>
      <label><input type="checkbox" id="t_m_gruppe"> Gruppen-/Partnerarbeit</label>
      <label><input type="checkbox" id="t_m_fragen"> Fragen stellen</label>
      <label><input type="checkbox" id="t_m_disk"> Diskussion</label>
    </div>
    <div>
      <h4>Medien</h4>
      <label><input type="checkbox" id="t_med_lehrbuch"> Lehrbuch</label>
      <label><input type="checkbox" id="t_med_blatt"> Arbeitsblätter</label>
      <label><input type="checkbox" id="t_med_white"> Whiteboard/Tafel</label>
      <label><input type="checkbox" id="t_med_beamer"> Laptop/Beamer/Smartboard</label>
      <label><input type="checkbox" id="t_med_handy"> Handy</label>
    </div>
  </div>

  <label class="label">Stimmung im Unterricht</label><textarea id="t_stimmung" rows="2"></textarea>
  <label class="label">Reaktionen der FS* auf Fragen/Aufgaben</label><textarea id="t_reaktion" rows="2"></textarea>
  <label class="label">Zusätzliche Methoden</label><textarea id="t_meth_extra" rows="2"></textarea>
  <label class="label">Zusätzliche Medien</label><textarea id="t_med_extra" rows="2"></textarea>
  <label class="label">Bemerkung</label><textarea id="t_bem" rows="2"></textarea>

  <div class="row">
    <button class="primary" onclick="saveTheorie()">Theorie speichern</button>
  </div>
</div>

<!-- PRAXIS – PDF 04 1:1 -->
<div id="praxis" class="card hidden">
  <h3>Beobachtungshilfe – Praktische Ausbildung</h3>

  <div class="row">
    <div><label class="label">Datum</label><input type="date" id="p_datum"></div>
    <div><label class="label">Dauer (Min)</label><input type="number" id="p_dauer"></div>
    <div>
      <label class="label">Art der Stunde</label>
      <select id="p_art">
        <option>Grundausbildung</option><option>Überlandfahrt</option>
        <option>Autobahnfahrt</option><option>Nachtfahrt</option>
        <option>Prüfungsvorbereitung</option>
      </select>
    </div>
  </div>

  <label class="label">Inhalte</label><textarea id="p_inhalte" rows="2"></textarea>

  <div class="row">
    <div>
      <h4>Methoden</h4>
      <label><input type="checkbox" id="p_m_demo"> Demonstration</label>
      <label><input type="checkbox" id="p_m_verb"> Verbale Anleitung</label>
      <label><input type="checkbox" id="p_m_nachf"> Nachfahren</label>
      <label><input type="checkbox" id="p_m_reflex"> Reflexion</label>
    </div>
    <div>
      <h4>Medien</h4>
      <label><input type="checkbox" id="p_med_modell"> Modellauto</label>
      <label><input type="checkbox" id="p_med_tablet"> Tablet</label>
      <label><input type="checkbox" id="p_med_blatt"> Arbeitsblatt</label>
      <label><input type="checkbox" id="p_med_schSkizze"> Skizzen / Zeichnungen</label>
    </div>
  </div>

  <h4>Beobachtung – Fahrkompetenzen</h4>
  <table>
    <thead>
      <tr>
        <th class="sticky">Aspekt</th>
        <th>++</th><th>+</th><th>°</th><th>–</th><th>––</th>
        <th>Bemerkung</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Fahrzeugbedienung</td>
        <td><input type="radio" name="p_bed" value="++"></td>
        <td><input type="radio" name="p_bed" value="+"></td>
        <td><input type="radio" name="p_bed" value="°"></td>
        <td><input type="radio" name="p_bed" value="-"></td>
        <td><input type="radio" name="p_bed" value="--"></td>
        <td><input id="p_bed_bem"></td>
      </tr>
      <tr>
        <td>Spiegel/Schulterblick</td>
        <td><input type="radio" name="p_sp" value="++"></td>
        <td><input type="radio" name="p_sp" value="+"></td>
        <td><input type="radio" name="p_sp" value="°"></td>
        <td><input type="radio" name="p_sp" value="-"></td>
        <td><input type="radio" name="p_sp" value="--"></td>
        <td><input id="p_sp_bem"></td>
      </tr>
      <tr>
        <td>Vorfahrt/Regeln</td>
        <td><input type="radio" name="p_vr" value="++"></td>
        <td><input type="radio" name="p_vr" value="+"></td>
        <td><input type="radio" name="p_vr" value="°"></td>
        <td><input type="radio" name="p_vr" value="-"></td>
        <td><input type="radio" name="p_vr" value="--"></td>
        <td><input id="p_vr_bem"></td>
      </tr>
      <tr>
        <td>Parken</td>
        <td><input type="radio" name="p_park" value="++"></td>
        <td><input type="radio" name="p_park" value="+"></td>
        <td><input type="radio" name="p_park" value="°"></td>
        <td><input type="radio" name="p_park" value="-"></td>
        <td><input type="radio" name="p_park" value="--"></td>
        <td><input id="p_park_bem"></td>
      </tr>
      <tr>
        <td>Abbiegen/Einordnen</td>
        <td><input type="radio" name="p_ab" value="++"></td>
        <td><input type="radio" name="p_ab" value="+"></td>
        <td><input type="radio" name="p_ab" value="°"></td>
        <td><input type="radio" name="p_ab" value="-"></td>
        <td><input type="radio" name="p_ab" value="--"></td>
        <td><input id="p_ab_bem"></td>
      </tr>
      <tr>
        <td>Autobahn</td>
        <td><input type="radio" name="p_abahn" value="++"></td>
        <td><input type="radio" name="p_abahn" value="+"></td>
        <td><input type="radio" name="p_abahn" value="°"></td>
        <td><input type="radio" name="p_abahn" value="-"></td>
        <td><input type="radio" name="p_abahn" value="--"></td>
        <td><input id="p_abahn_bem"></td>
      </tr>
      <tr>
        <td>Sicherheitsgefühl</td>
        <td><input type="radio" name="p_sich" value="++"></td>
        <td><input type="radio" name="p_sich" value="+"></td>
        <td><input type="radio" name="p_sich" value="°"></td>
        <td><input type="radio" name="p_sich" value="-"></td>
        <td><input type="radio" name="p_sich" value="--"></td>
        <td><input id="p_sich_bem"></td>
      </tr>
      <tr>
        <td>Selbstständigkeit</td>
        <td><input type="radio" name="p_self" value="++"></td>
        <td><input type="radio" name="p_self" value="+"></td>
        <td><input type="radio" name="p_self" value="°"></td>
        <td><input type="radio" name="p_self" value="-"></td>
        <td><input type="radio" name="p_self" value="--"></td>
        <td><input id="p_self_bem"></td>
      </tr>
    </tbody>
  </table>

  <label class="label">Stimmung</label><textarea id="p_stimmung" rows="2"></textarea>
  <label class="label">Beobachtung/Notiz</label><textarea id="p_bem" rows="3"></textarea>

  <div class="row">
    <button class="primary" onclick="savePraxis()">Praxis speichern</button>
  </div>
</div>

<!-- ÜBERSICHT -->
<div id="uebersicht" class="card hidden">
  <h3>Übersicht</h3>
  <div id="overview"></div>
</div>

<script>
/* =================== STORAGE KEYS =================== */
const LS_STUDENTS="fs_students_v1";
const LS_BER="fs_beratung_v1";
const LS_THEO="fs_theorie_v1";
const LS_PRAX="fs_praxis_v1";
const LS_CUR="fs_current";

/* =================== HELPERS =================== */
const getJ=(k,d)=>{try{return JSON.parse(localStorage.getItem(k)||d);}catch(_){return JSON.parse(d)}};
const setJ=(k,v)=>localStorage.setItem(k,JSON.stringify(v));
const q=(s)=>document.querySelector(s);
const id=(s)=>document.getElementById(s);
function activeSID(){return localStorage.getItem(LS_CUR)||"";}
function ensureSID(){const s=activeSID(); if(!s){alert("Bitte zuerst einen Fahrschüler wählen."); return null;} return s;}

/* =================== STUDENTS =================== */
function loadStudents(){
  const data=getJ(LS_STUDENTS,"{}");
  const sel=id("studentSelect");
  sel.innerHTML='<option value="">-- Bitte wählen --</option>'+
    Object.keys(data).map(k=>`<option value="${k}">${data[k].name} (${(data[k].klassen||[]).join(", ")})</option>`).join("");
  const cur=activeSID(); if(cur && data[cur]) sel.value=cur;
}
function addStudent(){
  const name=id("newStudentName").value.trim();
  const klassen=Array.from(id("klasseSelect").selectedOptions).map(o=>o.value);
  if(!name) return alert("Name fehlt.");
  if(klassen.length===0) return alert("Mindestens eine Klasse wählen.");
  const data=getJ(LS_STUDENTS,"{}");
  const sid=crypto.randomUUID();
  data[sid]={name,klassen};
  setJ(LS_STUDENTS,data);
  id("newStudentName").value=""; id("klasseSelect").selectedIndex=-1;
  localStorage.setItem(LS_CUR,sid);
  loadStudents();
  alert("Schüler angelegt.");
}
function deleteStudent(){
  const sid=activeSID(); if(!sid) return alert("Kein Schüler gewählt.");
  if(!confirm("Diesen Schüler samt Einträgen löschen?")) return;
  const S=getJ(LS_STUDENTS,"{}"); const B=getJ(LS_BER,"{}"); const T=getJ(LS_THEO,"{}"); const P=getJ(LS_PRAX,"{}");
  delete S[sid]; delete B[sid]; delete T[sid]; delete P[sid];
  setJ(LS_STUDENTS,S); setJ(LS_BER,B); setJ(LS_THEO,T); setJ(LS_PRAX,P);
  localStorage.removeItem(LS_CUR);
  loadStudents(); id("overview").innerHTML="";
  alert("Gelöscht.");
}
function onSelectStudent(){
  const v=id("studentSelect").value;
  if(v) localStorage.setItem(LS_CUR,v);
}

/* =================== TABS =================== */
function switchTab(tab){
  ["beratung","theorie","praxis","uebersicht"].forEach(t=>{
    id(t).classList.add("hidden");
    id("tab-"+t).classList.remove("active");
  });
  id(tab).classList.remove("hidden");
  id("tab-"+tab).classList.add("active");
  if(tab==="uebersicht") renderOverview();
}

/* =================== BERATUNG SAVE =================== */
function saveBeratung(){
  const sid=ensureSID(); if(!sid) return;
  const all=getJ(LS_BER,"{}");
  all[sid]=all[sid]||[];
  all[sid].push({
    datum:id("b_datum").value || new Date().toISOString().slice(0,10),
    dauer:id("b_dauer").value,
    partner:id("b_partner").value,
    klasse:id("b_klasse").value,
    inhalte:id("b_inhalte").checked,
    aengste:id("b_aengste").checked,
    fragen:id("b_fragen").checked,
    bem:id("b_bem").value,
    fehl:id("b_fehl").value,
    kosten:id("b_kosten").value,
    eindruck:id("b_eindruck").value,
    ts:Date.now()
  });
  setJ(LS_BER,all);
  alert("Beratung gespeichert.");
}

/* =================== THEORIE SAVE =================== */
function valRadio(name){const x=[...document.getElementsByName(name)].find(e=>e.checked);return x?x.value:"";}
function saveTheorie(){
  const sid=ensureSID(); if(!sid) return;
  const all=getJ(LS_THEO,"{}");
  all[sid]=all[sid]||[];
  all[sid].push({
    datum:id("t_datum").value || new Date().toISOString().slice(0,10),
    uhr:id("t_time").value,
    anzahl:id("t_anz").value,
    thema:id("t_thema").value,
    grund:id("t_grund").checked, zusatz:id("t_zusatz").checked,
    verhalten:{
      ton:valRadio("t_ton"), ton_b:id("t_ton_bem").value,
      laut:valRadio("t_laut"), laut_b:id("t_laut_bem").value,
      stimme:valRadio("t_stimme"), stimme_b:id("t_stimme_bem").value,
      tempo:valRadio("t_tempo"), tempo_b:id("t_tempo_bem").value,
      begr:valRadio("t_begr"), begr_b:id("t_begr_bem").value,
      gestik:valRadio("t_gestik"), gestik_b:id("t_gestik_bem").value,
      blick:valRadio("t_blick"), blick_b:id("t_blick_bem").value,
      mimik:valRadio("t_mimik"), mimik_b:id("t_mimik_bem").value,
      ls:valRadio("t_ls"), ls_b:id("t_ls_bem").value
    },
    methoden:{
      frontal:id("t_m_frontal").checked,
      lehr:id("t_m_lehr").checked,
      gruppe:id("t_m_gruppe").checked,
      fragen:id("t_m_fragen").checked,
      disk:id("t_m_disk").checked
    },
    medien:{
      lehrbuch:id("t_med_lehrbuch").checked,
      blatt:id("t_med_blatt").checked,
      white:id("t_med_white").checked,
      beamer:id("t_med_beamer").checked,
      handy:id("t_med_handy").checked
    },
    stimmung:id("t_stimmung").value,
    reaktion:id("t_reaktion").value,
    meth_extra:id("t_meth_extra").value,
    med_extra:id("t_med_extra").value,
    bem:id("t_bem").value,
    ts:Date.now()
  });
  setJ(LS_THEO,all);
  alert("Theorie gespeichert.");
}

/* =================== PRAXIS SAVE =================== */
function savePraxis(){
  const sid=ensureSID(); if(!sid) return;
  const all=getJ(LS_PRAX,"{}");
  all[sid]=all[sid]||[];
  all[sid].push({
    datum:id("p_datum").value || new Date().toISOString().slice(0,10),
    dauer:id("p_dauer").value,
    art:id("p_art").value,
    inhalte:id("p_inhalte").value,
    methoden:{
      demo:id("p_m_demo").checked,
      verbal:id("p_m_verb").checked,
      nachf:id("p_m_nachf").checked,
      reflex:id("p_m_reflex").checked
    },
    medien:{
      modell:id("p_med_modell").checked,
      tablet:id("p_med_tablet").checked,
      blatt:id("p_med_blatt").checked,
      skizze:id("p_med_schSkizze").checked
    },
    bew:{
      bed:valRadio("p_bed"), bed_b:id("p_bed_bem").value,
      sp:valRadio("p_sp"), sp_b:id("p_sp_bem").value,
      vr:valRadio("p_vr"), vr_b:id("p_vr_bem").value,
      park:valRadio("p_park"), park_b:id("p_park_bem").value,
      ab:valRadio("p_ab"), ab_b:id("p_ab_bem").value,
      abahn:valRadio("p_abahn"), abahn_b:id("p_abahn_bem").value,
      sich:valRadio("p_sich"), sich_b:id("p_sich_bem").value,
      self:valRadio("p_self"), self_b:id("p_self_bem").value
    },
    stimmung:id("p_stimmung").value,
    bem:id("p_bem").value,
    ts:Date.now()
  });
  setJ(LS_PRAX,all);
  alert("Praxis gespeichert.");
}

/* =================== OVERVIEW =================== */
function renderOverview(){
  const sid=ensureSID(); if(!sid){ id("overview").innerHTML=""; return; }
  const S=getJ(LS_STUDENTS,"{}")[sid];
  const B=getJ(LS_BER,"{}")[sid]||[];
  const T=getJ(LS_THEO,"{}")[sid]||[];
  const P=getJ(LS_PRAX,"{}")[sid]||[];
  let html = `<p><span class="badge">${S?.name||"Unbekannt"}</span> <span class="badge">${(S?.klassen||[]).join(", ")}</span></p>`;
  html += `<h4>Beratung (${B.length})</h4>` + B.map((x,i)=>`<details><summary>#${i+1} – ${x.datum}</summary><pre>${escape(JSON.stringify(x,null,2))}</pre></details>`).join("");
  html += `<h4>Theorie (${T.length})</h4>` + T.map((x,i)=>`<details><summary>#${i+1} – ${x.datum} ${x.thema||""}</summary><pre>${escape(JSON.stringify(x,null,2))}</pre></details>`).join("");
  html += `<h4>Praxis (${P.length})</h4>` + P.map((x,i)=>`<details><summary>#${i+1} – ${x.datum} ${x.art||""}</summary><pre>${escape(JSON.stringify(x,null,2))}</pre></details>`).join("");
  id("overview").innerHTML = html;
}
function escape(s){return s.replace(/[&<>"]/g,m=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;"}[m]))}

/* =================== INIT =================== */
window.addEventListener("load",()=>{
  loadStudents();
  switchTab("beratung");
});
</script>
</body>
</html>
